(this.webpackJsonpchat_project=this.webpackJsonpchat_project||[]).push([[0],{163:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n(0),r=n.n(a),s=n(16),i=n.n(s),o=n(18),u=(n(90),n(5)),l=n(2),d=n.n(l),b=n(8),j=n(9),h=n(7),m=n(78),p=n.n(m),O=n(24),f={data:null},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case"SET_USER":return{data:c};case"LOGOUT":return window.localStorage.TOKEN&&delete window.localStorage.TOKEN,R.defaults.headers.common.Authorization&&(R.defaults.headers.common.Authorization=null),{data:null};default:return e}},g=n(31),x=n(4),_={data:null,currentChat:null},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case"SET_CHAT_INFO":return Object(x.a)(Object(x.a)({},e),{},{data:c});case"SET_CURRENT_CHAT":return Object(x.a)(Object(x.a)({},e),{},{currentChat:c});case"ADD_NEW_MESSAGE":return Object(x.a)(Object(x.a)({},e),{},{currentChat:Object(x.a)(Object(x.a)({},e.currentChat),{},{messages:[].concat(Object(g.a)(e.currentChat.messages),[c])})});case"ADD_NEW_CHAT":return Object(x.a)(Object(x.a)({},e),{},{data:[].concat(Object(g.a)(e.data),[c])});case"ADD_NEW_CHAT_USER":var a=e.data,r=e.currentChat;return r._id===c.chat_id&&(r.members.find((function(e){return e._id===c._id}))||(r=Object(x.a)(Object(x.a)({},r),{},{members:[].concat(Object(g.a)(r.members),[c])}))),Array.isArray(e.data)&&(a=a.map((function(e){return e._id===c.chat_id?Object(x.a)(Object(x.a)({},e),{},{members:[].concat(Object(g.a)(e.members),[c])}):e}))),Object(x.a)(Object(x.a)({},e),{},{data:a,currentChat:r});case"LOGOUT":return{data:null,currentChat:null,currentChatId:null};default:return e}},N={io:null},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case"INIT_SOCKET":return{io:c};case"LOGOUT":return{io:null};default:return e}},w=Object(O.c)({user:v,chat:C,socket:y}),k=n(79),E=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||O.d,S=Object(O.e)(w,E(Object(O.a)(k.a))),T=p.a.create({baseURL:"http://mesichon.net/api",responseType:"json"}),A=window.localStorage.TOKEN;T.defaults.headers.common.Authorization="Bearer ".concat(A),T.interceptors.response.use((function(e){return e}),(function(e){return 401===e.response.status&&S.dispatch(M()),e}));var R=T,L={login:function(){var e=Object(b.a)(d.a.mark((function e(t){var n,c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.mail,c=t.pass,e.prev=1,e.next=4,R.post("/auth/login",{email:n,password:c});case 4:return a=e.sent,e.abrupt("return",a);case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),register:function(e){var t=e.mail,n=e.pass,c=e.name;return R.post("/auth/reg",{email:t,password:n,name:c})},getUser:function(){return R.get("/user").then((function(e){return e.data})).catch((function(e){console.log(e)}))},setChatInfo:function(e){return R.post("/client/chat/join",{type:e}).then((function(e){return e})).catch((function(e){console.log("Response error")}))}},I=n(113),D=function(){return function(e){return L.getUser().then((function(t){return t&&e(function(e){return{type:"SET_USER",payload:e}}(t)),t})).then((function(t){return t&&e({type:"INIT_SOCKET",payload:I("http://mesichon.net/api",{auth:{token:"Bearer ".concat(window.localStorage.TOKEN)}})}),t})).catch((function(e){console.log(e)}))}},U=function(e){return function(t){return L.login(e).then((function(e){var t=e.data,n=null===t||void 0===t?void 0:t.access_token;return window.localStorage.TOKEN=n,R.defaults.headers.common.Authorization="Bearer ".concat(n),t})).then((function(e){return t(D()),e})).catch((function(e){return console.log(e),e}))}},H=function(e){return function(t){return L.register(e).then((function(e){return e})).catch((function(e){return e}))}},M=function(){return{type:"LOGOUT",payload:null}},P=n(27),W=n.p+"static/media/user-icon.30a690b8.svg",K=n.p+"static/media/lock-icon.dc0e2e72.svg",F=function(e){e.props;var t=Object(h.b)(),n=Object(u.g)(),r=Object(a.useState)(""),s=Object(j.a)(r,2),i=s[0],o=s[1],l=Object(a.useState)(""),m=Object(j.a)(l,2),p=m[0],O=m[1],f=function(){var e=Object(b.a)(d.a.mark((function e(c){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.preventDefault(),t(U({mail:i,pass:p})).then((function(e){e?n.push("/join"):P.b.error("Wrong email or password!",{position:"top-center",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(c.jsxs)("form",{autoComplete:"off",action:"/",method:"post",onSubmit:f,children:[Object(c.jsxs)("div",{className:"field-wrap",children:[Object(c.jsx)("img",{src:"".concat(W),alt:""}),Object(c.jsx)("input",{type:"text",required:!0,autoComplete:"off",placeholder:"Login",value:i,onChange:function(e){return o(e.target.value)}})]}),Object(c.jsxs)("div",{className:"field-wrap",children:[Object(c.jsx)("img",{src:"".concat(K),alt:""}),Object(c.jsx)("input",{type:"password",required:!0,autoComplete:"off",placeholder:"Password",value:p,onChange:function(e){return O(e.target.value)}})]}),Object(c.jsxs)("div",{className:"checkbox",children:[Object(c.jsx)("input",{type:"checkbox",defaultChecked:"checked"}),Object(c.jsx)("label",{children:"Forget password"})]}),Object(c.jsx)("button",{className:"btn",type:"submit",children:"Log In"})]})},V=n(40),G=n(80),q=n.n(G),B=n(6),z=(new q.a).compile({name:{type:"string",min:1,messages:{required:"This field cannot be blank"}},mail:{type:"email",messages:{required:"This field cannot be blank",email:"Invalid e-mail"}},pass:{type:"string",min:6,max:30,messages:{required:"This field cannot be blank",stringMin:"Passord length must be 6-30 characters",stringMax:"Passord length must be 6-30 characters"}},agreement:{type:"equal",value:!0,messages:{equalValue:"You have to agree with Privacy Policy and Terms"}}}),X=function(e){var t=z(e);return t.length?t.reduce((function(e,t){return Object(x.a)(Object(x.a)({},e),{},Object(V.a)({},t.field,t.message))}),{}):null},J=function(e){e.props;var t=Object(h.b)(),n=Object(u.g)(),r=Object(a.useState)(""),s=Object(j.a)(r,2),i=s[0],o=s[1],l=Object(a.useState)(""),m=Object(j.a)(l,2),p=m[0],O=m[1],f=Object(a.useState)(""),v=Object(j.a)(f,2),g=v[0],x=v[1],_=Object(a.useState)(!1),C=Object(j.a)(_,2),N=C[0],y=C[1],w=Object(a.useState)({}),k=Object(j.a)(w,2),E=k[0],S=k[1],T=function(){var e=Object(b.a)(d.a.mark((function e(c){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.preventDefault(),a=X({mail:i,pass:p,name:g,agreement:N}),S(a),a||t(H({mail:i,pass:p,name:g,agreement:N})).then((function(e){200===(null===e||void 0===e?void 0:e.status)?t(U({mail:i,pass:p})).then((function(e){e&&n.push("/join")})):P.b.error("Something went wrong",{position:"top-center",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})})).catch((function(e){return console.log("ERROR",e)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(c.jsxs)("form",{autoComplete:"off",action:"/",method:"post",onSubmit:T,children:[Object(c.jsxs)("div",{className:Object(B.a)("field-wrap",{"field-wrap--err":null===E||void 0===E?void 0:E.name}),children:[Object(c.jsx)("img",{src:"".concat(W),alt:""}),Object(c.jsx)("input",{type:"text",autoComplete:"off",placeholder:"Full Name",value:g,onChange:function(e){return x(e.target.value)}})]}),Object(c.jsxs)("div",{className:Object(B.a)("field-wrap",{"field-wrap--err":null===E||void 0===E?void 0:E.mail}),children:[Object(c.jsx)("img",{src:"".concat(K),alt:""}),Object(c.jsx)("input",{type:"email",autoComplete:"off",placeholder:"E-mail",value:i,onChange:function(e){return o(e.target.value.toLowerCase())}})]}),Object(c.jsxs)("div",{className:Object(B.a)("field-wrap",{"field-wrap--err":null===E||void 0===E?void 0:E.pass}),children:[Object(c.jsx)("img",{src:"".concat(K),alt:""}),Object(c.jsx)("input",{type:"password",autoComplete:"off",placeholder:"Password",value:p,onChange:function(e){return O(e.target.value)}})]}),Object(c.jsxs)("div",{className:Object(B.a)("checkbox",{"checkbox--err":null===E||void 0===E?void 0:E.agreement}),children:[Object(c.jsx)("input",{type:"checkbox",id:"agreement",value:N,onChange:function(){return y((function(e){return!e}))}}),Object(c.jsxs)("label",{htmlFor:"agreement",children:["I accept the ",Object(c.jsx)("span",{children:" Privacy Policy"})," and ",Object(c.jsx)("span",{children:"Terms"})]}),(null===E||void 0===E?void 0:E.agreement)&&Object(c.jsxs)("span",{className:"field-wrap__error",children:["* ",E.agreement]})]}),Object(c.jsx)("button",{className:"btn btn--auth",type:"submit",children:"Create Account"})]})},Q=n.p+"static/media/sign-back.120789b9.png";var Y=function(e){return window.localStorage.TOKEN&&e.history.push("/join"),Object(c.jsx)("div",{className:"auth",style:{backgroundImage:"url("+Q+")",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"},children:Object(c.jsxs)("div",{className:"inner-container",children:[Object(c.jsx)("h1",{children:"Welcome to Chat"}),Object(c.jsxs)("p",{children:["Lorem ipsum dolor sit amet, consectetur ",Object(c.jsx)("br",{})," adipiscing elit."]}),Object(c.jsxs)("div",{className:"buttons",children:[Object(c.jsx)(o.b,{to:"/auth/signin",children:Object(c.jsx)("button",{className:"btn",children:"Sign In"})}),Object(c.jsx)(o.b,{to:"/auth/register",children:Object(c.jsx)("button",{className:"btn",children:"Sign Up"})})]}),Object(c.jsx)(u.b,{exact:!0,path:"/auth/signin",component:F}),Object(c.jsx)(u.b,{exact:!0,path:"/auth/register",component:J})]})})},Z={joinChat:function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.post("/client/chat/join",{type:t});case 3:return n=e.sent,e.abrupt("return",n);case 7:e.prev=7,e.t0=e.catch(0),console.log("Response error",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),sendMesage:function(e,t){R.post("/client/chat/".concat(e),{text:t})},sendAdminMesage:function(e,t){R.post("/admin/chat/".concat(e),{text:t})},getChat:function(){var e=Object(b.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("/client/chat");case 3:return t=e.sent,e.abrupt("return",t);case 7:e.prev=7,e.t0=e.catch(0),console.log("Response error",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),getAdminChat:function(){var e=Object(b.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("/admin/chat");case 3:return t=e.sent,e.abrupt("return",t);case 7:e.prev=7,e.t0=e.catch(0),console.log("Response error",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),getMessages:function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("/admin/chat/".concat(t));case 3:return n=e.sent,e.abrupt("return",n);case 7:e.prev=7,e.t0=e.catch(0),console.log("Response error",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},$=function(e){return{type:"SET_CHAT_INFO",payload:e}},ee=function(e){return function(){var t=Object(b.a)(d.a.mark((function t(n){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Z.joinChat(e).then((function(e){return n($(null===e||void 0===e?void 0:e.data)),n(ne(null===e||void 0===e?void 0:e.data)),e})).catch((function(e){console.log(e)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},te=function(){return function(){var e=Object(b.a)(d.a.mark((function e(t){var n,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.getChat();case 2:return n=e.sent,c=n.data,Object.keys(c).length?t(ne(c)):t(ne(null)),e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},ne=function(e){return{type:"SET_CURRENT_CHAT",payload:e}},ce=n.p+"static/media/join-bg.7a7f01a0.png";function ae(e){var t=e.history,n=Object(h.b)(),r=Object(h.c)((function(e){return{user:e.user.data}})).user,s=Object(a.useState)([]),i=Object(j.a)(s,2),o=i[0],u=i[1],l=Object(a.useCallback)((function(e){Object.keys(e).length?t.push("/chat"):R.get("/chat-types").then((function(e){var t=null===e||void 0===e?void 0:e.data;u(t)}))}),[t]);Object(a.useEffect)((function(){r||n(D()).then((function(e){"Admin"===(null===e||void 0===e?void 0:e.role.name)&&t.push("/chat"),"Client"===(null===e||void 0===e?void 0:e.role.name)&&n(te()).then((function(e){l(e)}))}))}),[l,n,r,t]);var m=function(){var e=Object(b.a)(d.a.mark((function e(c){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(ee(c.target.id)).then((function(){t.push("/chat")}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(c.jsx)("div",{className:"join",style:{backgroundImage:"url(".concat(ce,")")},children:Object(c.jsxs)("div",{className:"join__inner",children:[Object(c.jsx)("h1",{className:"join__title",children:"Welcome to Chat"}),Object(c.jsx)("p",{className:"join__text",children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit"}),Object(c.jsx)("div",{className:"join__buttons"}),null===o||void 0===o?void 0:o.map((function(e){return Object(c.jsx)("button",{name:e.name,id:e._id,onClick:m,className:"btn",children:e.name},e._id)}))]})})}var re=Object(u.h)(Object(a.memo)(ae)),se=n(81),ie=n.n(se),oe=n.p+"static/media/chat-sidebar-bg.37de6930.png",ue=n.p+"static/media/back-icon.68c0aaff.svg",le=n.p+"static/media/phone-icon.28f6dfd9.svg",de=n.p+"static/media/message-icon.f6ec0898.svg",be=function(e,t){var n=Object(h.b)();return Object(c.jsxs)("div",{className:Object(B.a)("sidebar",{"sidebar--visible":e.isVisible}),ref:t,children:[Object(c.jsxs)("div",{className:"sidebar__inner",style:{backgroundImage:"url(".concat(oe,")")},children:[Object(c.jsx)("img",{className:"sidebar__close",src:ue,alt:"",onClick:function(){return e.setSidebarVisible((function(e){return!e}))}}),Object(c.jsx)("h1",{children:"Chat"}),Object(c.jsx)("p",{children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit"}),Object(c.jsx)("div",{className:"sidebar__preview",children:Object(c.jsx)(ie.a,{url:"https://youtu.be/LXb3EKWsInQ",width:"100%",height:"100%"})}),Object(c.jsx)("p",{children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit"}),Object(c.jsxs)("div",{className:"sidebar__contacts",children:[Object(c.jsxs)("div",{className:"sidebar__contacts-phone",children:[Object(c.jsx)("img",{src:le,alt:""}),Object(c.jsx)("span",{children:"Lorem ipsum dolor sit amet"})]}),Object(c.jsxs)("div",{className:"sidebar__contacts-message",children:[Object(c.jsx)("img",{src:de,alt:""}),Object(c.jsx)("span",{children:"Lorem ipsum dolor sit amet"})]})]})]}),Object(c.jsx)("button",{className:"btn",onClick:function(){n(M()),e.history.push("/")},children:"Logout"})]})},je=Object(a.forwardRef)(be),he=n(82),me=n(83),pe=n.n(me),Oe=function(e){var t=null===e||void 0===e?void 0:e.substr(6,9).split("").map((function(e){return(t=e.charCodeAt(0))>255?255:t<0?0:t;var t})),n=Object(j.a)(t,3),c=n[0],a=n[1],r=n[2];return pe()({r:c,g:a,b:r}).lighten(15).brighten(10).saturate(45).toHexString()},fe=function(e){var t,n,a=e.data;return a&&(n=Oe(null===a||void 0===a?void 0:a._id)),Object(c.jsxs)("div",{className:"avatar",style:{background:n},children:[null===a||void 0===a||null===(t=a.members)||void 0===t?void 0:t[0].name[0].toUpperCase(),(null===a||void 0===a?void 0:a.name)&&(null===a||void 0===a?void 0:a.name[0].toUpperCase())]})},ve=function(e){var t=e.members;return Object(c.jsx)("div",{className:"members",children:null===t||void 0===t?void 0:t.map((function(e){return Object(c.jsxs)("div",{className:"members__item",children:[Object(c.jsx)("div",{className:"members__item-content",children:Object(c.jsx)("h3",{children:e.name})}),Object(c.jsx)(fe,{data:e})]},e._id)}))})},ge=n.p+"static/media/back-chats-icon.7acb9cbc.svg",xe=function(e){var t=e.chat,n=e.setSidebarVisible,a=e.userRole,r=Object(h.b)();return Object(c.jsxs)("div",{className:"topbar",children:[Object(c.jsxs)("div",{className:"burger",onClick:function(){n((function(e){return!e}))},children:[Object(c.jsx)("span",{className:"burger__block",children:" "}),Object(c.jsx)("span",{className:"burger__block",children:" "}),Object(c.jsx)("span",{className:"burger__block",children:" "})]}),t&&Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("div",{className:"topbar__content",children:[Object(c.jsx)("div",{className:"topbar__members",children:Object(c.jsx)("p",{children:null===t||void 0===t?void 0:t.members.map((function(e,t){return e.name})).join(", ")})}),Object(c.jsx)(he.a,{trigger:function(){var e;return Object(c.jsxs)("span",{children:[null===t||void 0===t||null===(e=t.members)||void 0===e?void 0:e.length," members"]})},closeOnDocumentClick:!0,on:["hover"],position:"bottom center",children:Object(c.jsx)(ve,{members:null===t||void 0===t?void 0:t.members})})]}),"Admin"===a&&Object(c.jsx)("img",{className:"topbar__back",src:ge,alt:"",onClick:function(){return r(ne(null))}})]})]})},_e=Object(a.memo)(xe),Ce=function(e){var t=e.messages,n=e.user,r=Object(a.useRef)();return Object(a.useEffect)((function(){r.current.scrollTo(0,r.current.scrollHeight)}),[t]),Object(c.jsx)("div",{className:"messages",ref:r,children:null===t||void 0===t?void 0:t.map((function(e){return Object(c.jsxs)("div",{className:Object(B.a)("messages__item",{"messages__item--is-me":(null===n||void 0===n?void 0:n._id)===(null===e||void 0===e?void 0:e.user._id)}),children:[Object(c.jsx)(fe,{data:e.user}),Object(c.jsx)("div",{className:"messages__item-content",children:Object(c.jsx)("p",{children:e.text})})]},e._id)}))})},Ne=function(e){var t=e.chat,n=e.socket,r=e.userRole,s=Object(a.useState)(""),i=Object(j.a)(s,2),o=i[0],u=i[1],l=Object(h.b)(),d=Object(a.useCallback)((function(e){t._id===e.chat_id&&l(function(e){return{type:"ADD_NEW_MESSAGE",payload:e}}(e))}),[t._id,l]);Object(a.useEffect)((function(){return null===n||void 0===n||n.on("MESSAGE",d),function(){null===n||void 0===n||n.removeEventListener("MESSAGE",d)}}),[n,l,d]);var b=function(){"Admin"===r&&l(function(e,t){return function(n){Z.sendAdminMesage(e,t)}}(t._id,o)),"Client"===r&&l(function(e,t){return function(n){Z.sendMesage(e,t)}}(t._id,o)),u("")};return Object(c.jsxs)("div",{className:"chat-input",children:[Object(c.jsx)("textarea",{value:o,onChange:function(e){return u(e.target.value)},onKeyDown:function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),o&&b())},placeholder:"Type a message..."}),Object(c.jsx)("button",{onClick:b,disabled:!o,children:"Type"})]})},ye=function(e){var t=e.socket,n=e.user,a=e.currentChat,r=e.setSidebarVisible;return Object(c.jsxs)("div",{className:"messages__history",children:[Object(c.jsx)(_e,{chat:a,setSidebarVisible:r,userRole:null===n||void 0===n?void 0:n.role.name}),a?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(Ce,{messages:null===a||void 0===a?void 0:a.messages,user:n}),Object(c.jsx)(Ne,{chat:a,socket:t,userRole:null===n||void 0===n?void 0:n.role.name})]}):Object(c.jsx)("div",{className:"messages__empty",children:"Choose a chat"})]})},we=function(e){var t=e.chats,n=e.currentChatId,a=Object(h.b)(),r=function(e){return function(){a(function(e){return function(){var t=Object(b.a)(d.a.mark((function t(n){var c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Z.getMessages(e);case 2:c=t.sent,n(ne(null===c||void 0===c?void 0:c.data));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(e))}};return Object(c.jsx)("div",{className:"chats",children:t&&t.map((function(e){return Object(c.jsxs)("div",{className:Object(B.a)("chats__item",{"chats__item--active":n===e._id}),onClick:r(e._id),children:[Object(c.jsx)("div",{className:"chats__item-content",children:Object(c.jsx)("h3",{children:e.members.map((function(e){return e.name})).join(", ")})}),Object(c.jsx)(fe,{data:e})]},e._id)}))})},ke=Object(a.memo)(we),Ee=Object(a.memo)(Object(u.h)((function(e){var t=e.history,n=Object(h.b)(),r=Object(h.c)((function(e){var t,n,c=e.chat,a=e.socket,r=e.user;return{chat:c.data,currentChat:c.currentChat,socket:a.io,user:r.data,userRole:null===(t=r.data)||void 0===t||null===(n=t.role)||void 0===n?void 0:n.name}})),s=r.currentChat,i=r.chat,o=r.socket,u=r.user,l=r.userRole,m=Object(a.useState)(!1),p=Object(j.a)(m,2),O=p[0],f=p[1],v=Object(a.useRef)(),g=Object(a.useCallback)((function(e){v.current&&!v.current.contains(e.target)&&"burger"!==e.target.className&&"burger__block"!==e.target.className&&f(!1)}),[v]),x=Object(a.useCallback)((function(e){"Admin"===(null===u||void 0===u?void 0:u.role.name)&&n(function(e){return{type:"ADD_NEW_CHAT",payload:e}}(e))}),[u,n]),_=Object(a.useCallback)((function(e){n(function(e){return{type:"ADD_NEW_CHAT_USER",payload:e}}(e))}),[n]);return Object(a.useEffect)((function(){return null===o||void 0===o||o.on("NEW_CHAT",x),null===o||void 0===o||o.on("NEW_USER",_),function(){null===o||void 0===o||o.removeEventListener("NEW_CHAT",x),null===o||void 0===o||o.removeEventListener("NEW_USER",_)}}),[o,x,_]),Object(a.useEffect)((function(){return document.addEventListener("click",g),function(){return document.removeEventListener("click",g)}}),[g]),Object(a.useEffect)((function(){u||n(D())}),[u,n]),Object(a.useEffect)((function(){i||("Admin"===l&&n(function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.getAdminChat();case 2:return n=e.sent,t($(null===n||void 0===n?void 0:n.data)),e.abrupt("return",null===n||void 0===n?void 0:n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),"Client"===l&&n(te()))}),[i,l,n]),Object(c.jsxs)("div",{className:"chat",children:[Object(c.jsx)(je,{isVisible:O,ref:v,history:t,setSidebarVisible:f}),Object(c.jsx)(ye,{socket:o,currentChat:s,user:u,setSidebarVisible:f}),Object(c.jsxs)("div",{className:Object(B.a)("chat__dialogs",{"chat__dialogs--visible":s,"chat__dialogs--hide":"Client"===l}),children:["Admin"===l&&Object(c.jsx)(ke,{chats:i,currentChatId:null===s||void 0===s?void 0:s._id}),"Client"===l&&Object(c.jsx)(ve,{members:null===s||void 0===s?void 0:s.members})]})]})}))),Se=n(84);var Te=function(e){var t=e.component,n=Object(Se.a)(e,["component"]);return Object(c.jsx)(u.b,Object(x.a)(Object(x.a)({},n),{},{render:function(){return window.localStorage.TOKEN?Object(c.jsx)(t,{}):Object(c.jsx)(u.a,{to:"/auth/signin"})}}))};var Ae=function(){return Object(c.jsxs)(u.d,{children:[Object(c.jsx)(Te,{exact:!0,path:["/join"],component:re}),Object(c.jsx)(Te,{exact:!0,path:["/","/chat"],component:Ee}),Object(c.jsx)(u.b,{path:"/auth",component:Y})]})},Re=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,166)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),r(e),s(e)}))};n(162);i.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(o.a,{children:Object(c.jsxs)(h.a,{store:S,children:[Object(c.jsx)(P.a,{}),Object(c.jsx)(Ae,{})]})})}),document.getElementById("root")),Re()},90:function(e,t,n){}},[[163,1,2]]]);
//# sourceMappingURL=main.7497e39d.chunk.js.map